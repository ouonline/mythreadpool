# This Makefile is generated by omake: https://github.com/ouonline/omake.git

CXX := g++
AR := ar

ifeq ($(debug), y)
	CXXFLAGS := -g
else
	CXXFLAGS := -O2 -DNDEBUG
endif
CXXFLAGS := $(CXXFLAGS) -Wall -Werror -Wextra -fPIC

TARGET := test_threadpool

.PHONY: all clean

all: $(TARGET)

test_threadpool_OBJS := ./thread_pool_test.cpp.test_threadpool.o

test_threadpool_INCLUDE := -I../..

test_threadpool_LIBS := ../libthreadpool.a -lpthread

./thread_pool_test.cpp.test_threadpool.o: ./thread_pool_test.cpp
	$(CXX) $(CXXFLAGS) $(test_threadpool_INCLUDE) -c $< -o $@

.PHONY: test_threadpool_pre_process

$(test_threadpool_OBJS): | test_threadpool_pre_process

test_threadpool_pre_process:
	$(MAKE) debug=$(debug) -C ..

test_threadpool: $(test_threadpool_OBJS)
	$(CXX) $(CXXFLAGS) -o $@ $^ $(test_threadpool_LIBS)

clean:
	rm -f $(TARGET) $(test_threadpool_OBJS)
